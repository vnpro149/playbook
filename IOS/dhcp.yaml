---
- name: Cau hinh dhcp tren router
  host: all
  gather_facts: no

  tasks:
    - name: cau hinh dhcp
      ios_config:
        parents:
          - ip dhcp pool '{{item.pool}}'
        lines:
          - network '{{item.ip}}'.0 '{{item.mask}}'
          - default-router '{{item.ip}}'.1
      with_items:
        - {pool: 12, ip: 10.10.12, mask: 255.255.255.0}
        - {pool: 13, ip: 10.10.13, mask: 255.255.255.0}
        - {pool: 14, ip: 10.10.14, mask: 255.255.255.0}
    - name: show dhcp
      ios_command:
        commands:
          - show ip dhcp pool
      register: show_dhcp
      
    - debug: var=show_dhcp.stdout.lines
